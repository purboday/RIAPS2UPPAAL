// Place template instantiations here.
{% set ns=namespace(processes='') %}
{% for compName, portData in compInfo.items() %}
{{compName}}Component = {{compName}}({{compName}}_socket);
{% if loop.first %}
{% set ns.processes = compName ~ 'Component' %}
{% else %}
{% set ns.processes = ns.processes ~ ',' ~ compName ~ 'Component' %}
{% endif %}
{% for portName, portAttr in portData.ports.items() %}
{% if portAttr.type == 'sub' %}
{{compName}}_{{portName}} = subscribe_port({{portAttr.msgtype[0]}}_channel, {{compName}}_{{portName}}_q);
{% set ns.processes = ns.processes ~ ',' ~ compName ~ '_' ~ portName %}
{% elif portAttr.type == 'req' %}
{{compName}}_{{portName}} = request_port({{portAttr.msgtype[1]}}_channel, {{compName}}_{{portName}}_q);
{% set ns.processes = ns.processes ~ ',' ~ compName ~ '_' ~ portName %}
{% elif portAttr.type == 'rep' %}
{{compName}}_{{portName}} = reply_port({{portAttr.msgtype[0]}}_channel, {{compName}}_{{portName}}_q);
{% set ns.processes = ns.processes ~ ',' ~ compName ~ '_' ~ portName %}
{% elif portAttr.type == 'qry' %}
{{compName}}_{{portName}} = query_port({{portAttr.msgtype[1]}}_channel, {{compName}}_{{portName}}_q);
{% set ns.processes = ns.processes ~ ',' ~ compName ~ '_' ~ portName %}
{% elif portAttr.type == 'ans' %}
{{compName}}_{{portName}} = answer_port({{portAttr.msgtype[0]}}_channel, {{compName}}_{{portName}}_q);
{% set ns.processes = ns.processes ~ ',' ~ compName ~ '_' ~ portName %}
{% elif portAttr.type == 'tim' %}
{{compName}}_{{portName}} = timer_port({{compName}}_{{portName}}_activate, {{compName}}_{{portName}}_deactivate, {{compName}}_{{portName}}_start, {{compName}}_{{portName}}_cancel, {{compName}}_{{portName}}_terminate, {{compName}}_{{portName}}_setDelay, {{compName}}_{{portName}}_q, {{compName}}_{{portName}}_delay, {{portAttr.period}}, {% if portAttr.timertype == 'periodic' %}true, true, true {% else %}false, false, false {% endif %},{{portAttr.period}});
{% set ns.processes = ns.processes ~ ',' ~ compName ~ '_' ~ portName %}
{% endif %}
{% endfor %}
{{compName}}Scheduler = batchscheduler_{{compName}}({{compName}}_sockets, {{compName}}_socket);
{% set ns.processes = ns.processes ~ ',' ~ compName ~ 'Scheduler' %}
{% endfor %}
TransitionHelper = urgent_edge();
// List one or more processes to be composed into a system.
system {{ns.processes}},TransitionHelper;